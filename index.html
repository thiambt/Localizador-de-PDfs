<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Localizador de PDFs</title>
    <!-- Inclui a biblioteca Tailwind CSS para estilização rápida. Esta linha carrega o CSS do Tailwind diretamente. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Importa a fonte 'Inter' do Google Fonts para um design moderno. */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #121212;
            color: #E0E0E0;
        }
        /* Define a largura máxima do container principal para manter o conteúdo centrado e legível em telas grandes. */
        .container {
            max-width: 960px;
        }
        /* Estiliza o grupo de input e botão, fazendo com que fiquem um abaixo do outro em telas pequenas. */
        .input-group {
            display: flex;
            gap: 1rem;
            flex-direction: column;
        }
        /* Em telas maiores (a partir de 640px), muda a direção para que o input e o botão fiquem lado a lado. */
        @media (min-width: 640px) {
            .input-group {
                flex-direction: row;
            }
        }
        /* Adiciona uma classe para esconder elementos visualmente, mas mantê-los acessíveis para leitores de tela. */
        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200">
    <div class="container mx-auto p-4 flex flex-col items-center min-h-screen">
        <!-- Seção do cabeçalho com o título e subtítulo da página. -->
        <header class="text-center my-8">
            <h1 class="text-4xl sm:text-5xl font-bold mb-2">Localizador de PDFs</h1>
            <p class="text-lg sm:text-xl text-gray-400">Insira uma URL para encontrar e listar todos os arquivos PDF.</p>
        </header>

        <main class="w-full max-w-2xl bg-gray-800 p-6 rounded-2xl shadow-lg">
            <!-- Grupo de entrada do utilizador: input para a URL e botão de busca. -->
            <div class="input-group mb-6">
                <!-- Adiciona um rótulo (label) para o input, essencial para acessibilidade. O 'for' conecta o rótulo ao input. -->
                <label for="urlInput" class="visually-hidden">Insira a URL para buscar PDFs</label>
                <input type="url" id="urlInput" placeholder="Ex: https://example.com" class="flex-grow p-3 rounded-lg bg-gray-700 text-gray-200 border border-gray-600 focus:border-blue-500 focus:outline-none transition-colors" required>
                <!-- O texto do botão já é descritivo o suficiente para ser usado como rótulo de acessibilidade. -->
                <button id="searchButton" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition-transform transform hover:scale-105 active:scale-95">
                    Buscar PDFs
                </button>
            </div>

            <!-- Área para exibir mensagens de status ou erro para o utilizador.
            O atributo 'aria-live="polite"' faz com que leitores de tela anunciem atualizações nesta área. -->
            <div id="statusMessage" role="status" aria-live="polite" class="text-center text-red-400 mb-4 hidden"></div>

            <!-- Indicador de carregamento que aparece enquanto a busca está a decorrer. -->
            <div id="loadingIndicator" class="flex justify-center items-center py-4 hidden">
                <svg class="animate-spin -ml-1 mr-3 h-8 w-8 text-blue-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" aria-hidden="true">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                <span>Buscando...</span>
            </div>

            <!-- Container para exibir os resultados da busca. Inicialmente escondido.
            O 'role="region"' e 'aria-labelledby' definem esta seção como um bloco de conteúdo principal. -->
            <div id="resultsContainer" role="region" aria-labelledby="resultsHeading" class="hidden">
                <h2 id="resultsHeading" class="text-2xl font-bold mb-4">PDFs Encontrados</h2>
                <div class="flex items-center justify-between mb-4">
                    <p id="pdfCount" class="text-sm text-gray-400"></p>
                    <button id="copyAllButton" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition-transform transform hover:scale-105 active:scale-95 text-sm">
                        Copiar todos os links
                    </button>
                </div>
                <div id="pdfList" class="space-y-3"></div>
            </div>

            <!-- Mensagem exibida quando nenhum PDF é encontrado. -->
            <div id="noResults" class="text-center py-8 hidden">
                <p class="text-xl text-gray-400">Nenhum PDF encontrado nesta página.</p>
            </div>
        </main>
    </div>

    <!-- Seção de JavaScript para toda a lógica da aplicação. -->
    <script>
        // Seleciona os elementos HTML pelo seu ID e os armazena em variáveis.
        const urlInput = document.getElementById('urlInput');
        const searchButton = document.getElementById('searchButton');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const statusMessage = document.getElementById('statusMessage');
        const resultsContainer = document.getElementById('resultsContainer');
        const pdfList = document.getElementById('pdfList');
        const pdfCount = document.getElementById('pdfCount');
        const copyAllButton = document.getElementById('copyAllButton');
        const noResults = document.getElementById('noResults');

        // Adiciona um "ouvinte de evento" ao botão de busca. Quando o botão é clicado, a função é executada.
        searchButton.addEventListener('click', async () => {
            const url = urlInput.value.trim();
            // Verifica se o campo de URL não está vazio.
            if (!url) {
                showStatus('Por favor, insira uma URL válida.', 'text-red-400');
                return;
            }

            // Esconde todas as seções de resultado e exibe o indicador de carregamento.
            hideAllSections();
            loadingIndicator.classList.remove('hidden');

            try {
                // Utiliza um serviço de proxy (`corsproxy.io`) para contornar problemas de CORS.
                // O `encodeURIComponent` garante que a URL seja segura para ser usada na URL do proxy.
                const proxyUrl = `https://corsproxy.io/?${encodeURIComponent(url)}`;
                
                // A função `fetch` faz a requisição HTTP. O `await` pausa a execução até a resposta chegar.
                const response = await fetch(proxyUrl);
                
                // Verifica se a resposta da requisição foi bem-sucedida (status 200 OK).
                if (!response.ok) {
                    throw new Error(`Erro ao carregar a URL: ${response.status} ${response.statusText}`);
                }

                // Lê o conteúdo da resposta como texto.
                const text = await response.text();
                // Cria um analisador de HTML para processar o texto e transformá-lo num objeto DOM.
                const parser = new DOMParser();
                const doc = parser.parseFromString(text, 'text/html');

                // Encontra todos os elementos `<a>` (links) na página.
                const links = Array.from(doc.querySelectorAll('a'));
                const pdfLinks = [];

                // Itera sobre todos os links encontrados.
                links.forEach(link => {
                    let href = link.getAttribute('href');
                    // Garante que o link existe e termina com '.pdf' (insensível a maiúsculas/minúsculas).
                    if (href && href.toLowerCase().endsWith('.pdf')) {
                        try {
                            // Converte links relativos (ex: /docs/file.pdf) em links absolutos.
                            const absoluteUrl = new URL(href, url).href;
                            pdfLinks.push(absoluteUrl);
                        } catch (e) {
                            console.error('URL inválida encontrada:', href);
                        }
                    }
                });

                // Chama a função para exibir os links de PDF encontrados.
                displayResults(pdfLinks);
            } catch (error) {
                // Se ocorrer um erro na busca, exibe uma mensagem para o utilizador.
                console.error('Erro na busca:', error);
                showStatus(`Erro: Não foi possível carregar a URL. Isso pode ser um problema de CORS.`, 'text-red-400');
            } finally {
                // Independentemente do resultado (sucesso ou erro), esconde o indicador de carregamento.
                loadingIndicator.classList.add('hidden');
            }
        });

        // Adiciona um ouvinte para o botão "Copiar todos os links".
        copyAllButton.addEventListener('click', () => {
            // Pega todos os links de PDF na lista e junta-os numa única string, separados por uma quebra de linha.
            const links = Array.from(document.querySelectorAll('#pdfList a')).map(a => a.href).join('\n');
            // Cria um elemento de texto temporário para copiar o conteúdo para a área de transferência.
            const tempInput = document.createElement('textarea');
            tempInput.value = links;
            document.body.appendChild(tempInput);
            tempInput.select();
            // `document.execCommand('copy')` é uma API mais antiga para copiar, mas funciona bem para a maioria dos navegadores.
            document.execCommand('copy');
            document.body.removeChild(tempInput);
            showStatus('Links copiados para a área de transferência!', 'text-green-400');
        });

        // Função responsável por exibir os links de PDF na interface.
        function displayResults(links) {
            pdfList.innerHTML = ''; // Limpa a lista de resultados anterior.
            if (links.length > 0) {
                // Itera sobre cada link de PDF.
                links.forEach(link => {
                    const fileName = link.split('/').pop(); // Extrai o nome do arquivo da URL.
                    const listItem = document.createElement('div');
                    listItem.className = "flex items-center justify-between p-3 bg-gray-700 rounded-lg transition-transform transform hover:scale-[1.01]";
                    
                    // Adiciona o HTML para o item da lista.
                    listItem.innerHTML = `
                        <div class="flex items-center min-w-0">
                            <!-- Ícone de PDF. O 'aria-hidden' garante que o ícone é ignorado por leitores de tela. -->
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 flex-shrink-0 mr-2" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 2h2v2H6V6zm2 4H6v2h2v-2zm2 2h2v2h-2v-2zm-2 2H6v2h2v-2zm4-2h2v2h-2v-2zm-4-2h2v2h-2v-2z" clip-rule="evenodd" />
                            </svg>
                            <!-- Link para o PDF. O 'target="_blank"' faz com que o link abra numa nova aba. -->
                            <a href="${link}" target="_blank" rel="noopener noreferrer" class="truncate text-blue-400 hover:text-blue-300 transition-colors">
                                ${fileName}
                            </a>
                        </div>
                        <div class="flex-shrink-0 ml-4 space-x-2">
                            <!-- Botão para copiar o link individualmente. -->
                            <button class="copy-link bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition-transform transform hover:scale-105 active:scale-95 text-xs">
                                Copiar
                            </button>
                            <!-- Botão para baixar o PDF. O 'download' força o download do arquivo. -->
                            <a href="${link}" download target="_blank" class="download-link bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition-transform transform hover:scale-105 active:scale-95 text-xs hidden sm:inline-block">
                                Baixar
                            </a>
                        </div>
                    `;
                    pdfList.appendChild(listItem);
                });

                // Adiciona o ouvinte de evento para cada novo botão "Copiar".
                document.querySelectorAll('.copy-link').forEach(button => {
                    button.addEventListener('click', (event) => {
                        const link = event.target.closest('.flex').querySelector('a').href;
                        const tempInput = document.createElement('textarea');
                        tempInput.value = link;
                        document.body.appendChild(tempInput);
                        tempInput.select();
                        document.execCommand('copy');
                        document.body.removeChild(tempInput);
                        event.target.textContent = 'Copiado!';
                        setTimeout(() => {
                            event.target.textContent = 'Copiar';
                        }, 2000);
                        showStatus('Link copiado para a área de transferência!', 'text-green-400');
                    });
                });

                // Adiciona um ouvinte de evento para cada novo botão "Baixar".
                document.querySelectorAll('.download-link').forEach(link => {
                    link.addEventListener('click', (event) => {
                        // Altera as classes do botão para dar a indicação visual de que já foi clicado.
                        const button = event.currentTarget;
                        button.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                        button.classList.add('bg-gray-500', 'hover:bg-gray-600');
                        // Opcionalmente, pode alterar o texto do botão.
                        button.textContent = 'Baixado';
                    });
                });


                // Atualiza a contagem de PDFs encontrados e exibe o container de resultados.
                pdfCount.textContent = `${links.length} arquivo(s) PDF encontrado(s).`;
                resultsContainer.classList.remove('hidden');
                noResults.classList.add('hidden');
            } else {
                // Se nenhum link for encontrado, exibe a mensagem de "sem resultados".
                noResults.classList.remove('hidden');
                resultsContainer.classList.add('hidden');
            }
        }

        // Função de utilidade para exibir mensagens de status.
        function showStatus(message, colorClass) {
            statusMessage.textContent = message;
            statusMessage.className = `text-center mb-4 ${colorClass}`;
            statusMessage.classList.remove('hidden');
            // A mensagem desaparece automaticamente após 5 segundos.
            setTimeout(() => {
                statusMessage.classList.add('hidden');
            }, 5000);
        }

        // Função para esconder todas as seções de resultado e status.
        function hideAllSections() {
            statusMessage.classList.add('hidden');
            resultsContainer.classList.add('hidden');
            noResults.classList.add('hidden');
        }
    </script>
</body>
</html>
